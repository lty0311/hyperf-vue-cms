(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e891739e"],{"38d5":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{class:e.icon}),e._v(" "+e._s(e.title)+"\n            ")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"名称"},model:{value:e.query.title,callback:function(t){e.$set(e.query,"title",t)},expression:"query.title"}}),a("el-cascader",{staticClass:"mr10",attrs:{options:e.options,props:{checkStrictly:!0,value:"id",label:"title",children:"subs"},placeholder:"上级权限",clearable:""},on:{change:e.changePid}}),a("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"状态"},model:{value:e.query.status,callback:function(t){e.$set(e.query,"status",t)},expression:"query.status"}},[a("el-option",{key:"-1",attrs:{label:"全部",value:"-1"}}),a("el-option",{key:"1",attrs:{label:"启用",value:"1"}}),a("el-option",{key:"0",attrs:{label:"禁用",value:"0"}})],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")])],1),a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-del",attrs:{type:"primary",icon:"el-icon-lx-delete"},on:{click:e.delAllSelection}},[e._v("批量删除")]),a("el-button",{staticClass:"handle-add mr10",attrs:{type:"primary",icon:"el-icon-lx-add"},on:{click:e.handleAdd}},[e._v("新增")])],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:"","header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"id",label:"ID",width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"title",label:"名称",align:"center"}}),a("el-table-column",{attrs:{label:"类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.type?a("el-tag",{attrs:{type:"primary"}},[e._v("一级菜单")]):2==t.row.type?a("el-tag",{attrs:{type:"success"}},[e._v("二级菜单")]):3==t.row.type?a("el-tag",{attrs:{type:"warning"}},[e._v("三级菜单")]):a("el-tag",{attrs:{type:"info"}},[e._v("功能权限")])]}}])}),a("el-table-column",{attrs:{prop:"icon",label:"图标",align:"center",width:"220"}}),a("el-table-column",{attrs:{prop:"index",label:"路由",align:"center"}}),a("el-table-column",{attrs:{prop:"uri",label:"接口路径",align:"center",width:"280"}}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:1==t.row.status?"success":"danger"}},[e._v(e._s(1==t.row.status?"启用":"禁用"))])]}}])}),a("el-table-column",{attrs:{prop:"sort",label:"排序",align:"center"}}),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"180"}}),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-lx-delete"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.query.page,"page-size":e.query.size,total:e.total},on:{"current-change":e.handlePageChange}})],1)],1),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"新增",visible:e.addVisible,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(t){e.addVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"70px"}},[a("el-alert",{staticClass:"mb20",attrs:{title:"注意：上级权限、类型 一旦保存后就不允许修改，请谨慎填写",type:"error",center:"","show-icon":""}}),a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:e.addForm.title,callback:function(t){e.$set(e.addForm,"title",t)},expression:"addForm.title"}})],1),a("el-form-item",{attrs:{label:"上级权限"}},[a("el-cascader",{ref:"cascaderInesrt",staticClass:"mr10",attrs:{options:e.options,props:{checkStrictly:!0,value:"id",label:"title",children:"subs"},placeholder:"非必填",clearable:""},on:{change:e.changeInsert}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-radio-group",{model:{value:e.addForm.type,callback:function(t){e.$set(e.addForm,"type",t)},expression:"addForm.type"}},[a("el-radio",{attrs:{label:1,disabled:e.isDisabled[1]}},[e._v("一级菜单")]),a("el-radio",{attrs:{label:2,disabled:e.isDisabled[2]}},[e._v("二级菜单")]),a("el-radio",{attrs:{label:3,disabled:e.isDisabled[3]}},[e._v("三级菜单")]),a("el-radio",{attrs:{label:4,disabled:e.isDisabled[4]}},[e._v("功能")])],1)],1),a("el-form-item",{attrs:{label:"icon图标"}},[a("el-input",{attrs:{placeholder:"非必填"},model:{value:e.addForm.icon,callback:function(t){e.$set(e.addForm,"icon",t)},expression:"addForm.icon"}})],1),a("el-form-item",{attrs:{label:"路由"}},[a("el-input",{attrs:{placeholder:"非必填"},model:{value:e.addForm.index,callback:function(t){e.$set(e.addForm,"index",t)},expression:"addForm.index"}})],1),a("el-form-item",{attrs:{label:"接口路径"}},[a("el-input",{model:{value:e.addForm.uri,callback:function(t){e.$set(e.addForm,"uri",t)},expression:"addForm.uri"}})],1),a("el-form-item",{attrs:{label:"排序"}},[a("el-input-number",{staticClass:"mr10",attrs:{min:-1e4,max:1e4},model:{value:e.addForm.sort,callback:function(t){e.$set(e.addForm,"sort",t)},expression:"addForm.sort"}}),a("span",[e._v("默认255，越大越靠前")])],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-radio-group",{model:{value:e.addForm.status,callback:function(t){e.$set(e.addForm,"status",t)},expression:"addForm.status"}},[a("el-radio",{attrs:{label:1}},[e._v("启用")]),a("el-radio",{attrs:{label:0}},[e._v("禁用")])],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveAdd}},[e._v("确 定")])],1)],1),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"编辑",visible:e.editVisible,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[a("el-alert",{staticClass:"mb20",attrs:{title:"注意：上级权限、类型 不允许修改，请删除后重新新增",type:"error",center:"","show-icon":""}}),a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"上级权限"}},[a("el-cascader",{ref:"cascaderUpdate",staticClass:"mr10",attrs:{options:e.options,disabled:"",props:{checkStrictly:!0,value:"id",label:"title",children:"subs"},placeholder:"非必填",clearable:""},model:{value:e.form.pid,callback:function(t){e.$set(e.form,"pid",t)},expression:"form.pid"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-radio-group",{attrs:{disabled:""},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-radio",{attrs:{label:1}},[e._v("一级菜单")]),a("el-radio",{attrs:{label:2}},[e._v("二级菜单")]),a("el-radio",{attrs:{label:3}},[e._v("三级菜单")]),a("el-radio",{attrs:{label:4}},[e._v("功能")])],1)],1),a("el-form-item",{attrs:{label:"icon图标"}},[a("el-input",{model:{value:e.form.icon,callback:function(t){e.$set(e.form,"icon",t)},expression:"form.icon"}})],1),a("el-form-item",{attrs:{label:"路由"}},[a("el-input",{model:{value:e.form.index,callback:function(t){e.$set(e.form,"index",t)},expression:"form.index"}})],1),a("el-form-item",{attrs:{label:"接口路径"}},[a("el-input",{model:{value:e.form.uri,callback:function(t){e.$set(e.form,"uri",t)},expression:"form.uri"}})],1),a("el-form-item",{attrs:{label:"排序"}},[a("el-input-number",{staticClass:"mr10",attrs:{min:-1e4,max:1e4},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}}),a("span",[e._v("数字越大越靠前")])],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-radio",{attrs:{label:1}},[e._v("启用")]),a("el-radio",{attrs:{label:0}},[e._v("禁用")])],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1)],1)},i=[],s=a("365c"),r=a("3de1"),o={data:function(){return{query:{title:"",status:"",pid:"",page:1,size:20},tableData:[],multipleSelection:[],editVisible:!1,addVisible:!1,addForm:{status:1,type:1,sort:255,pid:0},total:0,form:{},idx:-1,id:-1,title:"",icon:"",options:[],isDisabled:{1:!0,2:!0,3:!0,4:!0}}},created:function(){this.title=this.$route.meta.title,this.icon=this.$route.meta.icon,this.getData(),this.resetCascader()},methods:{resetCascader:function(){var e=this;Object(s["b"])("permissionCascader",{}).then((function(t){e.options=t.data||[]})).catch((function(e){}))},changePid:function(e){0==e.length?this.query.pid=0:this.query.pid=e[e.length-1]},changeInsert:function(e){if(0==e.length?this.addForm.pid=0:this.addForm.pid=e[e.length-1],this.isDisabled={1:!0,2:!0,3:!0,4:!0},0!=this.addForm.pid){var t=this.$refs.cascaderInesrt.getCheckedNodes(),a=t[0]["data"]["type"]||"";1==a?(this.addForm.type=2,this.isDisabled[2]=!1,this.isDisabled[4]=!1):2==a&&(this.addForm.type=4,this.isDisabled[3]=!1,this.isDisabled[4]=!1)}else this.addForm.type=1},resetAddForm:function(){this.$refs.cascaderInesrt.handleClear(),this.addForm={status:1,type:1,sort:255,pid:0}},getData:function(){var e=this;Object(s["b"])("permission",this.query).then((function(t){var a=t.data;e.tableData=a.data,e.total=a.total||0})).catch((function(t){Object(r["a"])(e,t)}))},handleSearch:function(){this.$set(this.query,"page",1),this.getData()},handleDelete:function(e,t){var a=this;this.$confirm("确定要删除 ["+t.title+"] 吗？","提示",{type:"warning"}).then((function(){Object(s["b"])("permissionbatchDelete",{ids:[t.id]}).then((function(t){a.$message.success("删除成功"),a.tableData.splice(e,1),a.resetCascader()})).catch((function(e){Object(r["a"])(a,e)}))})).catch((function(){}))},handleSelectionChange:function(e){this.multipleSelection=e},delAllSelection:function(){var e=this;this.$confirm("确定要批量删除吗？","提示",{type:"warning"}).then((function(){var t=e.multipleSelection.length;if(!t)return!1;for(var a="",l=[],i=0;i<t;i++)a+=e.multipleSelection[i].title+" ",l.push(e.multipleSelection[i].id);Object(s["b"])("permissionbatchDelete",{ids:l}).then((function(t){e.$message.success("删除了".concat(a)),e.multipleSelection=[],e.getData(),e.resetCascader()})).catch((function(t){Object(r["a"])(e,t)}))})).catch((function(){}))},handleEdit:function(e,t){this.idx=e,this.form=Object.assign({},t),this.editVisible=!0},handleAdd:function(){this.addVisible=!0},saveAdd:function(){var e=this;Object(s["b"])("permissionInsert",this.addForm).then((function(t){e.$message.success("新增成功"),e.getData(),e.resetCascader(),e.addVisible=!1,e.resetAddForm()})).catch((function(t){Object(r["a"])(e,t)}))},saveEdit:function(){var e=this;Object(s["b"])("permissionUpdate",this.form).then((function(t){e.$message.success("修改成功"),e.$set(e.tableData,e.idx,e.form),e.resetCascader(),e.editVisible=!1})).catch((function(t){Object(r["a"])(e,t)}))},handlePageChange:function(e){this.$set(this.query,"page",e),this.getData()}}},n=o,c=(a("b7bc"),a("5d22")),d=Object(c["a"])(n,l,i,!1,null,"d09d5d42",null);t["default"]=d.exports},"3de1":function(e,t,a){"use strict";function l(e,t){e.$message.error(t),1015==t.code&&e.$router.push("/login",(function(e){}),(function(e){}))}a.d(t,"a",(function(){return l}))},7450:function(e,t,a){},b7bc:function(e,t,a){"use strict";a("7450")}}]);